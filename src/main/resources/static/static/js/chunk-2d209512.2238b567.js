(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d209512"],{a915:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:t.onOpen}},[t._v("新增")]),a("el-button",{attrs:{disabled:t.updateButtonDisable,type:"success",icon:"el-icon-edit",size:"mini"},on:{click:t.alterOnOpen}},[t._v("修改")]),a("el-button",{attrs:{disabled:t.deleteButtonDisable,type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:t.open}},[t._v("删除")]),a("el-button",{attrs:{type:"warning",icon:"el-icon-document",size:"mini"},on:{click:t.handleDownload}},[t._v("导出当前页")]),a("el-button",{attrs:{disabled:!1,type:"danger",icon:"el-icon-document",size:"mini"},on:{click:t.handleDownloadAll}},[t._v("导出所有页")])],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%",margin:"15px auto"},attrs:{data:t.tableData,"tooltip-effect":"dark",border:"","highlight-current-row":"","show-header":"","header-cell-style":{background:"#EBEEF5",color:"#606266"}},on:{select:t.handleSelect,"select-all":t.handleSelectAll}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"post_id",label:"岗位编号"}}),a("el-table-column",{attrs:{prop:"post_name",label:"岗位名称"}}),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"post_salary",label:"岗位工资"}}),a("el-table-column",{attrs:{prop:"dept_name",label:"所属部门"}})],1),[a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:t.listQuery.total,"current-page":t.listQuery.pageNum,"page-size":t.listQuery.pageSize,"page-sizes":[5,10,20,30,50]},on:{"update:currentPage":function(e){return t.$set(t.listQuery,"pageNum",e)},"update:current-page":function(e){return t.$set(t.listQuery,"pageNum",e)},"update:pageSize":function(e){return t.$set(t.listQuery,"pageSize",e)},"update:page-size":function(e){return t.$set(t.listQuery,"pageSize",e)},"current-change":t.pageChange,"size-change":t.sizeChange}})],[a("div",[a("el-dialog",{attrs:{title:"添加岗位",visible:t.dialogFormVisible,width:"36%"},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.onClose}},[a("el-form",{ref:"ruleForm",attrs:{model:t.formData,rules:t.rules,"label-width":"200px","status-icon":!0}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"岗位名","label-width":"120px",size:"small",prop:"postName"}},[a("el-input",{staticStyle:{width:"360px"},attrs:{placeholder:"请输入岗位名",size:"small"},model:{value:t.formData.postName,callback:function(e){t.$set(t.formData,"postName",e)},expression:"formData.postName"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"岗位工资","label-width":"120px",size:"small",prop:"postSalary"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入岗位工资",size:"small"},model:{value:t.formData.postSalary,callback:function(e){t.$set(t.formData,"postSalary",t._n(e))},expression:"formData.postSalary"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"所属部门","label-width":"120px",size:"small",prop:"deptId"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择所属部门",clearable:"",size:"small"},model:{value:t.formData.deptId,callback:function(e){t.$set(t.formData,"deptId",e)},expression:"formData.deptId"}},t._l(t.options,(function(t){return a("el-option",{key:t.dept_id,attrs:{label:t.dept_name,value:t.dept_id}})})),1)],1)],1)],1),a("el-row",[a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("立即添加")]),a("el-button",{attrs:{plain:"",type:"warning",size:"small"},on:{click:function(e){return t.resetForm("ruleForm")}}},[t._v("清空表单")])],1)],1)],1)],1)],1)],[a("div",[a("el-dialog",{attrs:{title:"修改信息",visible:t.alterDialog,width:"36%"},on:{"update:visible":function(e){t.alterDialog=e},close:t.alterOnClose}},[a("el-form",{ref:"alterRuleForm",attrs:{model:t.alterFormData,rules:t.rules,"label-width":"200px","status-icon":!0}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"岗位名","label-width":"120px",size:"small",prop:"postName"}},[a("el-input",{staticStyle:{width:"360px"},attrs:{placeholder:"请输入岗位名",size:"small"},model:{value:t.alterFormData.postName,callback:function(e){t.$set(t.alterFormData,"postName",e)},expression:"alterFormData.postName"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"岗位工资","label-width":"120px",size:"small",prop:"postSalary"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入岗位工资",size:"small"},model:{value:t.alterFormData.postSalary,callback:function(e){t.$set(t.alterFormData,"postSalary",t._n(e))},expression:"alterFormData.postSalary"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"所属部门","label-width":"120px",size:"small",prop:"deptId"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择所属部门",clearable:"",size:"small"},model:{value:t.alterFormData.deptId,callback:function(e){t.$set(t.alterFormData,"deptId",e)},expression:"alterFormData.deptId"}},t._l(t.options,(function(t){return a("el-option",{key:t.dept_id,attrs:{label:t.dept_name,value:t.dept_id}})})),1)],1)],1)],1),a("el-row",[a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.alterRuleForm("alterRuleForm")}}},[t._v("立即修改")]),a("el-button",{attrs:{plain:"",type:"warning",size:"small"},on:{click:function(e){return t.resetForm("alterRuleForm")}}},[t._v("重置表单")])],1)],1)],1)],1)],1)]],2)},o=[],i=(a("159b"),a("d81d"),a("d3b7"),a("3ca3"),a("ddb0"),a("b775"));function r(t,e,a){return Object(i["a"])({url:"/api/posts",method:"get",params:{pageNum:t,pageSize:e,token:a}})}function n(t){return Object(i["a"])({url:"/api/post",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/api/post/delete",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/api/post/update",method:"post",data:t})}function c(t){return Object(i["a"])({url:"/api/dept/options",method:"get",params:{token:t}})}var p=a("c1df"),m=a.n(p),d={components:{},data:function(){return{listQuery:{total:0,pageNum:1,pageSize:10},tableData:[],dialogFormVisible:!1,alterDialog:!1,updateButtonDisable:!0,deleteButtonDisable:!0,delPrimaryKeySet:[],formData:{postName:void 0,postSalary:void 0,deptId:void 0},alterFormData:{postId:void 0,postName:void 0,postSalary:void 0,deptId:void 0},options:[],rules:{postName:[{required:!0,message:"请输入岗位名",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字符",trigger:"blur"}],postSalary:[{required:!0,message:"岗位工资不能为空"},{type:"number",message:"岗位工资必须为数字值"}],deptId:[{required:!0,message:"请选择所属部门",trigger:"change"}]}}},beforeCreate:function(){},created:function(){this.getPostList(this.listQuery.pageNum,this.listQuery.pageSize),this.initSelectForm()},methods:{initSelectForm:function(){var t=this;c(this.$store.getters.token).then((function(e){t.options=e.data})).catch((function(t){console.log(t)}))},pageChange:function(){this.getPostList(this.listQuery.pageNum,this.listQuery.pageSize)},sizeChange:function(t){this.getPostList(1,t)},open:function(){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.handleDelete()})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleDelete:function(){var t=this,e={};this.delPrimaryKeySet.forEach((function(t,a){e[a]=t})),s(e).then((function(e){t.$message.info("删除成功"),t.listQuery.pageNum=1,t.getPostList(t.listQuery.pageNum,t.listQuery.pageSize)})).catch((function(e){t.$message.error("删除失败"),console.log(e)}))},handleSelectAll:function(t){var e=[];t.forEach((function(t){e.push(t.post_id)})),this.delPrimaryKeySet=e,t.length>0?this.deleteButtonDisable=!1:0===t.length&&(this.deleteButtonDisable=!0)},handleSelect:function(t,e){var a=[];t.forEach((function(t){a.push(t.post_id)})),this.delPrimaryKeySet=a,1===t.length?this.updateButtonDisable=!1:1!==t.length&&(this.updateButtonDisable=!0),t.length>0?this.deleteButtonDisable=!1:0===t.length&&(this.deleteButtonDisable=!0)},getTableHeader:function(t){var e=[],a=0;for(var l in t)e[a]=l,a++;return e},objectToArray:function(t){for(var e=[],a=0,l=["post_id","post_name","create_time","post_salary","dept_name"],o=0,i=l;o<i.length;o++){var r=i[o];e[a++]=t[r]?t[r]:""}return e},formatJson:function(t){var e=this;return t.map((function(t){return e.objectToArray(t)}))},handleDownload:function(){var t=["岗位编号","岗位名称","创建时间","岗位工资","所属部门"],e=this.formatJson(this.tableData);Promise.all([a.e("chunk-960adaac"),a.e("chunk-60bd4d29")]).then(a.bind(null,"4bf8")).then((function(a){a.export_json_to_excel({header:t,data:e,filename:"post-page-list",autoWidth:!0,bookType:"xlsx"})}))},handleDownloadAll:function(){var t=this,e=[];new Promise((function(a,l){r(1,t.listQuery.total,t.$store.getters.token).then((function(t){e=t.data.list,e.forEach((function(t){t.create_time&&(t.create_time=m()(t.create_time).format("YYYY-MM-DD HH:mm:ss"))})),a()})).catch((function(t){console.log(t),l()}))})).then((function(){var l=["岗位编号","岗位名称","创建时间","岗位工资","所属部门"],o=t.formatJson(e);Promise.all([a.e("chunk-960adaac"),a.e("chunk-60bd4d29")]).then(a.bind(null,"4bf8")).then((function(t){t.export_json_to_excel({header:l,data:o,filename:"post-all-list",autoWidth:!0,bookType:"xlsx"})}))}))},getPostList:function(t,e){var a=this;r(t,e,this.$store.getters.token).then((function(t){a.tableData=t.data.list,a.tableData.forEach((function(t){t.create_time&&(t.create_time=m()(t.create_time).format("YYYY-MM-DD HH:mm:ss"))})),a.listQuery.total=t.data.total})).catch((function(t){console.log(t)}))},onOpen:function(){this.dialogFormVisible=!0},alterOnOpen:function(){var t=this;this.alterDialog=!0,this.tableData.forEach((function(e){e.post_id===t.delPrimaryKeySet[0]&&(t.alterFormData.postId=e.post_id,t.alterFormData.postName=e.post_name,t.alterFormData.postSalary=e.post_salary,t.alterFormData.deptId=e.dept_id)}))},onClose:function(){},alterOnClose:function(){},alterRuleForm:function(t){var e=this;this.$refs[t].validate((function(a){if(!a)return!1;new Promise((function(t,a){u(e.alterFormData).then((function(){e.getPostList(e.listQuery.pageNum,e.listQuery.pageSize),e.deleteButtonDisable=!0,e.updateButtonDisable=!0,e.$message.info("修改成功"),e.listQuery.pageNum=1,e.getPostList(e.listQuery.pageNum,e.listQuery.pageSize),t()})).catch((function(t){e.$message.error("修改失败"),a(t)}))})).then((function(){e.resetForm(t),e.alterDialog=!1})).catch((function(t){console.log(t)}))}))},submitForm:function(t){var e=this;this.$refs[t].validate((function(a){if(!a)return!1;new Promise((function(t,a){n(e.formData).then((function(){e.listQuery.pageNum=1,e.getPostList(e.listQuery.pageNum,e.listQuery.pageSize),e.$message.info("添加成功"),t()})).catch((function(t){e.$message.error("添加失败"),a(t)}))})).then((function(){e.resetForm(t),e.dialogFormVisible=!1})).catch((function(t){console.log(t)}))}))},resetForm:function(t){this.$refs[t].resetFields()}}},f=d,h=a("2877"),g=Object(h["a"])(f,l,o,!1,null,"1fba8382",null);e["default"]=g.exports}}]);